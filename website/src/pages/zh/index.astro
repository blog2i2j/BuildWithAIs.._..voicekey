---
/**
 * Voice Key 官网首页（中文）
 */
import { Image } from 'astro:assets'
import BaseLayout from '@layouts/BaseLayout.astro'
import logoImage from '../../assets/logo.png'
import {
  Download,
  Github,
  Keyboard,
  Globe,
  Shield,
  Zap,
  Monitor,
  LayoutTemplate,
  Command,
} from 'lucide-react'
import LanguageSwitch from '@components/LanguageSwitch.astro'
import ThemeToggle from '@components/ThemeToggle.astro'

const title = 'Voice Key - 语音转文字，一键输入'
const description = '按住热键说话，松手即输入到任意应用。Voice Key 是一款跨平台应用（支持 macOS 与 Windows），专注于快速语音转文字转换。'

// Feature data
const features = [
  {
    icon: Keyboard,
    title: '按住说话 (PTT)',
    desc: '按住热键说话，松手即输入。零延迟工作流。',
  },
  {
    icon: Globe,
    title: '多语言支持',
    desc: '支持中文、英文等多语言混合输入。智能上下文检测。',
  },
  {
    icon: Shield,
    title: '隐私优先',
    desc: '本地优先架构。您的声音数据完全保留在您的设备上。',
  },
  {
    icon: Zap,
    title: '极速响应',
    desc: '亚秒级识别速度。比思维更快的输入体验。',
  },
  {
    icon: Monitor,
    title: '跨平台支持',
    desc: '原生支持 macOS 与 Windows。一致的极客体验。',
  },
  {
    icon: LayoutTemplate,
    title: '现代化 HUD',
    desc: '非侵入式悬浮窗。提供精确的录音状态可视化反馈。',
  },
]
---

<BaseLayout title={title} description={description} lang="zh">
  <!-- Hero Section -->
  <section
    class="relative min-h-screen flex items-center justify-center overflow-hidden pt-20 pb-32"
  >
    <!-- Top Right Controls -->
    <div class="absolute top-4 right-4 md:top-8 md:right-8 z-50 flex items-center gap-2">
      <ThemeToggle />
      <LanguageSwitch lang="zh" />
    </div>

    <!-- Ambient Glow -->
    <div
      class="absolute inset-0 bg-linear-to-b from-primary/5 via-transparent to-transparent blur-3xl opacity-30 pointer-events-none"
    >
    </div>

    <div class="relative z-10 text-center px-6 max-w-5xl mx-auto flex flex-col items-center">
      <!-- Version Tag (Geek Style) -->
      <div
        class="inline-flex items-center gap-2 rounded-md border border-border bg-muted/50 px-3 py-1 font-mono text-xs text-muted-foreground mb-8 backdrop-blur-md animate-fade-in hover:border-primary/50 transition-colors cursor-default"
      >
        <span class="relative flex h-2 w-2">
          <span
            class="animate-ping absolute inline-flex h-full w-full rounded-full bg-primary opacity-75"
          ></span>
          <span class="relative inline-flex rounded-full h-2 w-2 bg-primary"
          ></span>
        </span>
        <span class="latest-version-text">v0.1.6</span>
        <span class="w-px h-3 bg-border mx-1"></span>
        <span class="text-foreground">Stable Build</span>
      </div>

      <!-- Hero Content -->
      <div class="mb-10 relative group">
        <!-- Orange Glow Effect -->
        <div
          class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-32 h-32 bg-primary/20 blur-[40px] rounded-full group-hover:bg-primary/30 transition-all duration-700"
        >
        </div>
        
        <div
          class="relative cursor-pointer w-32 h-32 rounded-[22px] flex items-center justify-center bg-background/50 backdrop-blur-sm ring-1 ring-white/10 shadow-2xl overflow-hidden"
        >
          <Image
            src={logoImage}
            alt="Voice Key Logo"
            width={96}
            height={96}
            class="w-24 h-24 object-cover"
          />
        </div>
      </div>

      <h1
        class="text-5xl md:text-7xl font-bold mb-6 text-foreground animate-fade-in tracking-tighter"
      >
        Voice Key
      </h1>

      <p
        class="text-xl md:text-2xl text-muted-foreground mb-10 max-w-2xl animate-slide-up leading-relaxed"
      >
        语音转文字，一键输入
        <br />
        <span class="text-foreground/80 font-medium"
          >按住热键说话，松手即输入到任意应用</span
        >
      </p>

      <!-- CLI / Action Buttons (Geek Style: rounded-md, font-mono) -->
      <div
        class="flex flex-col sm:flex-row gap-4 justify-center animate-slide-up w-full sm:w-auto"
      >
        <a
          href="https://github.com/BuildWithAIs/voicekey/releases/latest"
          class="group relative inline-flex items-center justify-center gap-3 overflow-hidden rounded-md bg-primary px-8 py-4 font-mono text-sm font-bold text-primary-foreground shadow-lg transition-all hover:bg-primary/90 hover:shadow-primary/25 hover:scale-[1.02]"
        >
          <Download className="w-5 h-5" />
          <span>免费下载</span>
          <div
            class="absolute inset-0 -z-10 bg-linear-to-r from-transparent via-white/20 to-transparent translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-700"
          >
          </div>
        </a>

        <a
          href="https://github.com/BuildWithAIs/voicekey"
          class="inline-flex items-center justify-center gap-3 rounded-md border border-border bg-background/50 px-8 py-4 font-mono text-sm font-medium text-foreground backdrop-blur-sm transition-all hover:bg-muted hover:border-primary/50"
        >
          <Github className="w-5 h-5" />
          <span>源代码</span>
        </a>
      </div>
      
      <!-- OS Support Badges -->
      <div class="mt-8 flex gap-4 text-xs font-mono text-muted-foreground opacity-60">
        <span class="flex items-center gap-1.5"><Command className="w-3 h-3"/> macOS (Universal)</span>
        <span class="flex items-center gap-1.5"><Monitor className="w-3 h-3"/> Windows (x64)</span>
      </div>
    </div>
  </section>

  <!-- Features Grid (Geek Style: Borders, Grid, Mono) -->
  <section class="py-24 px-6 relative border-t border-border">
    <div
      class="absolute inset-0 bg-muted/20 bg-[radial-gradient(#80808012_1px,transparent_1px)] bg-[size:20px_20px]"
    >
    </div>
    
    <div class="max-w-6xl mx-auto relative z-10">
      <div class="text-center mb-16">
        <h2 class="text-3xl md:text-4xl font-bold text-foreground mb-4 tracking-tight">
          系统核心模块
        </h2>
        <p class="font-mono text-xs text-primary/80 uppercase tracking-widest">
          // Core Modules Loaded
        </p>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {
          features.map((feature) => (
            <div class="group relative overflow-hidden rounded-lg border border-border bg-card/30 backdrop-blur-sm p-6 hover:border-primary/50 transition-all duration-300 hover:shadow-lg hover:shadow-primary/5">
              <!-- Corner Accents -->
              <div class="absolute top-0 left-0 w-2 h-2 border-l border-t border-primary/30 group-hover:border-primary/80 transition-colors"></div>
              <div class="absolute top-0 right-0 w-2 h-2 border-r border-t border-primary/30 group-hover:border-primary/80 transition-colors"></div>
              <div class="absolute bottom-0 left-0 w-2 h-2 border-l border-b border-primary/30 group-hover:border-primary/80 transition-colors"></div>
              <div class="absolute bottom-0 right-0 w-2 h-2 border-r border-b border-primary/30 group-hover:border-primary/80 transition-colors"></div>

              <div class="mb-5 inline-flex items-center justify-center rounded bg-primary/10 p-2.5 text-primary ring-1 ring-inset ring-primary/20 group-hover:scale-110 transition-transform duration-300">
                <feature.icon className="w-6 h-6" />
              </div>
              
              <h3 class="font-mono text-lg font-bold text-foreground mb-2 group-hover:text-primary transition-colors">
                {feature.title}
              </h3>
              <p class="text-sm text-muted-foreground leading-relaxed">
                {feature.desc}
              </p>
            </div>
          ))
        }
      </div>
    </div>
  </section>

  <!-- Footer (Minimalist) -->
  <footer class="py-12 px-6 border-t border-border bg-background relative z-10">
    <div class="max-w-6xl mx-auto flex flex-col md:flex-row justify-between items-center gap-6 text-sm text-muted-foreground font-mono">
      <div class="flex items-center gap-2">
        <span class="w-2 h-2 bg-green-500 rounded-full"></span>
        <span>系统运行正常</span>
      </div>
      
      <p>© 2026 Voice Key 开放源代码项目</p>
      
      <div class="flex gap-6">
        <a
          href="https://github.com/BuildWithAIs/voicekey"
          class="hover:text-primary transition-colors"
        >
          GitHub
        </a>
      </div>
    </div>
  </footer>
  <script is:inline>
    (async function updateVersion() {
      const STORAGE_KEY = 'voice-key-version';
      const CACHE_TIME = 24 * 60 * 60 * 1000; // 24 hours

      function updateDOM(version) {
        if (!version) return;
        document.querySelectorAll('.latest-version-text').forEach(el => {
          el.textContent = version;
        });
      }

      try {
        // Check cache
        const cached = localStorage.getItem(STORAGE_KEY);
        if (cached) {
          const { version, timestamp } = JSON.parse(cached);
          if (Date.now() - timestamp < CACHE_TIME) {
            updateDOM(version);
            return;
          }
        }

        // Fetch new
        const response = await fetch('https://api.github.com/repos/BuildWithAIs/voicekey/releases/latest');
        if (!response.ok) return;
        
        const data = await response.json();
        const tagName = data.tag_name;
        
        if (tagName) {
          updateDOM(tagName);
          localStorage.setItem(STORAGE_KEY, JSON.stringify({
            version: tagName,
            timestamp: Date.now()
          }));
        }
      } catch (e) {
        console.debug('Version check failed:', e);
      }
    })();
  </script>
</BaseLayout>
